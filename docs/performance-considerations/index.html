<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ConfigurationOptions/performance-considerations">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Performance Considerations | Cloud Carbon Footprint</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cloud-carbon-footprint.github.io/docs/performance-considerations"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Performance Considerations | Cloud Carbon Footprint"><meta data-rh="true" name="description" content="Improving Query Performance and Handling Large Data"><meta data-rh="true" property="og:description" content="Improving Query Performance and Handling Large Data"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://cloud-carbon-footprint.github.io/docs/performance-considerations"><link data-rh="true" rel="alternate" href="https://cloud-carbon-footprint.github.io/docs/performance-considerations" hreflang="en"><link data-rh="true" rel="alternate" href="https://cloud-carbon-footprint.github.io/docs/performance-considerations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://L8RY6HBDJZ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloud Carbon Footprint RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloud Carbon Footprint Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Cloud Carbon Footprint" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.c3e29cd2.css">
<link rel="preload" href="/assets/js/runtime~main.cb91f6b3.js" as="script">
<link rel="preload" href="/assets/js/main.8fe9b0da.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cloud Carbon Footprint</b></a><a class="navbar__item navbar__link navbar__link" href="/docs/getting-started">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://demo.cloudcarbonfootprint.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Demo</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Github</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/methodology">How it Works</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/methodology">Methodology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/embodied-emissions">Embodied Emissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classifying-usage-types">Classifying Usage Types</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/introduction">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/aws">Connecting Data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/data-persistence-and-caching">Configuration Options</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data-persistence-and-caching">Data Persistence and Caching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/performance-considerations">Performance Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tagging">Tagging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configurations-glossary">Configurations Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/emissions-factors">Emissions Factors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/backstage-plugins">Integrations</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Configuration Options</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Performance Considerations</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Performance Considerations</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improving-query-performance-and-handling-large-data">Improving Query Performance and Handling Large Data<a href="#improving-query-performance-and-handling-large-data" class="hash-link" aria-label="Direct link to Improving Query Performance and Handling Large Data" title="Direct link to Improving Query Performance and Handling Large Data">​</a></h2><p>When running very large amounts of data, we noticed there may be some issues in the time it takes to load estimates and to receive a response from the app. Depending on the configuration of your environment, querying for dates with significant amount of usage may result in long request times, runtime errors, or even cause requests to fail. While we work hard to continuously optimize and improve CCF for large organizations and usages, we recommend considering the following to help avoid some of these issues:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="considerations-for-large-requests">Considerations for Large Requests<a href="#considerations-for-large-requests" class="hash-link" aria-label="Direct link to Considerations for Large Requests" title="Direct link to Considerations for Large Requests">​</a></h2><p>When querying for a specific date range, you may encounter instances where the requested date range has a large amount of usage for the app to process. Depending on the environment in which your CCF app is running, this may cause requests to stall or timeout due to memory issues. We recommend doing the following:</p><ul><li>Backfill and seed large amounts of data using the <a href="/docs/data-persistence-and-caching#seeding-cache-file">Seed Cache File</a> method. (Recommended)</li><li>Decrease the date range of the request to reduce the amount of estimates needed to be calculated</li><li>Disable other cloud provider configurations to reduce the amount of cloud providers being queried in one request</li></ul><p>Backfilling and seeding the cache is useful for handling the calculation of a large amount of data. Using this method will allow for calculated estimates to be saved, enabling faster subsequent requests with less overhead for those date ranges to be viewed in the client or output in the API/CLI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="date-range-considerations">Date Range Considerations<a href="#date-range-considerations" class="hash-link" aria-label="Direct link to Date Range Considerations" title="Direct link to Date Range Considerations">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="date-range-via-the-client">Date Range via the Client<a href="#date-range-via-the-client" class="hash-link" aria-label="Direct link to Date Range via the Client" title="Direct link to Date Range via the Client">​</a></h3><p>When using the client dashboard and running very large amounts of data with the default configuration of querying each day for the previous year, we have noticed that the time it takes to start the app increases significantly.</p><p>In your <code>packages/client/.env</code> file, you can provide the following variables for a custom date range:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-date-range">Custom Date Range<a href="#custom-date-range" class="hash-link" aria-label="Direct link to Custom Date Range" title="Direct link to Custom Date Range">​</a></h4><p>Optionally set the date range to query data based on custom start/end timestamps.</p><ul><li><code>REACT_APP_START_DATE</code> (yyyy-mm-dd)</li><li><code>REACT_APP_END_DATE</code> (yyyy-mm-dd)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="date-range-from-today-legacy-configuration">Date Range from Today (Legacy Configuration)<a href="#date-range-from-today-legacy-configuration" class="hash-link" aria-label="Direct link to Date Range from Today (Legacy Configuration)" title="Direct link to Date Range from Today (Legacy Configuration)">​</a></h4><p>Optionally set the date range to query the data starting back in days/weeks/months/quarters/years to the current date</p><ul><li><code>REACT_APP_DATE_RANGE_TYPE</code> (example values: day(s), week(s), month(s), etc..)</li><li><code>REACT_APP_DATE_RANGE_VALUE</code> (example values: number correlating to day/week/month etc..)</li></ul><p><em>Note</em>: If set, these will take least precedence over all other date range configurations.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="group-by-timestamp-in-queries">Group By Timestamp in Queries<a href="#group-by-timestamp-in-queries" class="hash-link" aria-label="Direct link to Group By Timestamp in Queries" title="Direct link to Group By Timestamp in Queries">​</a></h3><p>In your <code>packages/client/.env</code> file, you can provide the following variable for a custom query option to group the data by date type:</p><ul><li><code>REACT_APP_GROUP_BY</code> (example values: day, week, month, quarter, year)</li></ul><p>Please Note:</p><ul><li>Data grouped by time periods other than days will usually honor the time period of the grouping over a specific date range that falls within the range. For example, when data is grouped by month and the dates Oct. 18 - Nov. 12 are requested, the API and UI will return one data point for November that includes all available data for the month of November (1st - 30th). Behavior when requesting specific dates including portions of the group by period may not be consistent due to caching.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-performance-considerations">Azure Performance Considerations<a href="#azure-performance-considerations" class="hash-link" aria-label="Direct link to Azure Performance Considerations" title="Direct link to Azure Performance Considerations">​</a></h2><p>When fetching usage data from Azure, we take a different approach from the other cloud providers in which we query the Consumption Management API in order to fetch usage data. This is because Azure currently does not provide a way to execute large SQL queries
against an exported billing table. As a result, we query the UsageDetails endpoint of the <a href="https://learn.microsoft.com/en-us/rest/api/consumption/" target="_blank" rel="noopener noreferrer">Azure Consumption API</a> to gather usage data for each subscription in the provided account.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limit-and-retry-logic">Rate Limit and Retry Logic<a href="#rate-limit-and-retry-logic" class="hash-link" aria-label="Direct link to Rate Limit and Retry Logic" title="Direct link to Rate Limit and Retry Logic">​</a></h3><p>Due to the required frequency for fetching this amount of data from the API, requests may be subject to API throttling and rate limiting. We have added some logic to help with this issue, but it is important to note that the more subscriptions you have in your Azure account, the more requests will be made to the API and the more likely you are to encounter rate limit warnings.</p><p>In the chance of exceeding rate limits, we have implemented retry logic for each subscription in which we wait the required amount of time specified in the response error before retrying the request again (usually 60 seconds). When this issue is encountered, you will see the following warning logged in the console:</p><div class="language-zsh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-zsh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ConsumptionManagement] warn: Azure ConsumptionManagementClient UsageDetailRow paging for time range [startDate] to [endDate] failed. Reason: Too many requests. Please retry after 60 seconds.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this instance, no action is needed and usage data will be fetched after the retry period has passed. However, each subscription can only attempt a <em>maximum of 10 retries</em> before it will be skipped and excluded from the calculated estimates. When this occurs, a relevant warning will be logged to the console with details on which subscription was affected. If you encounter this issue, we recommend making a separate request for the affected subscription(s) or to explore one of the configuration options below to reduce the scope of the request.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-options">Configuration Options<a href="#configuration-options" class="hash-link" aria-label="Direct link to Configuration Options" title="Direct link to Configuration Options">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="subscription-chunking">Subscription Chunking<a href="#subscription-chunking" class="hash-link" aria-label="Direct link to Subscription Chunking" title="Direct link to Subscription Chunking">​</a></h4><p>If you have a large number of subscriptions, you may encounter rate limits when fetching estimates. To reduce the likelihood of this happening across <em>multiple</em> subscriptions, you can customize the number of subscriptions to query at a time. To do this, assign a number to <code>AZURE_SUBSCRIPTION_CHUNKS</code> in the <code>.env</code> file located in either the <code>packages/api</code> or <code>packages/cli</code> directories.</p><p>By default, CCF will query usage data in chunks of <strong>10 subscriptions at a time</strong>. You will see the following log confirming the chunk size:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fetching Azure consumption data with ${AZURE.SUBSCRIPTION_CHUNKS} chunk(s).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="date-chunking">Date Chunking<a href="#date-chunking" class="hash-link" aria-label="Direct link to Date Chunking" title="Direct link to Date Chunking">​</a></h4><p>To reduce the frequency of rate limits for a <em>single</em> subscription for a large date range, you can split the date range for the requests into smaller chunks. To enable this feature, we&#x27;ve added a configuration option to do this in your <code>packages/api/.env</code> and <code>packages/cli/.env</code> files by assigning a number to the <code>AZURE_CONSUMPTION_CHUNKS_DAYS</code> variable.</p><p>In doing so, this will split the requests into smaller chunks of specified days (i.e. assigning a value of 3 will make a request for every 3 days in the requested date range). When enabled, you will see the following log confirming the chunk size:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Time range will be requested in chunks of ${AZURE_CONSUMPTION_CHUNK_DAYS} days.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>...in addition to a similar log for each chunk to indicate the request progress:</p><div class="language-zsh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-zsh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ConsumptionManagement] debug: Querying consumption usage details from 2023-02-28T00:00:00.000Z to 2023-03-01T23:59:59.999Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="combining-configurations">Combining Configurations<a href="#combining-configurations" class="hash-link" aria-label="Direct link to Combining Configurations" title="Direct link to Combining Configurations">​</a></h4><p>You can optimize requests for a large number of subscriptions with large datasets by using both subscription and date chunking together. However, be cautious when using certain configurations for both chunked subscriptions and days, as they may result in more frequent small requests than necessary and increase the likelihood of rate limits. It&#x27;s best to use both as a last resort and prioritize subscription chunking with an appropriate date range and grouping method provided for the request instead.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="specifying-accounts">Specifying Accounts<a href="#specifying-accounts" class="hash-link" aria-label="Direct link to Specifying Accounts" title="Direct link to Specifying Accounts">​</a></h2><p>By default, CCF will query usage data for all accounts under the provided billing account for each provider. Naturally, for large accounts, this could result in a large amount of data being queried at once. There may be some instances where you would prefer to only calculate estimates for specified subscriptions within an account or reduce the scope of a request to improve performance. To do so, you can provide a list of specific account IDs to query by adding the appropriate variable to your <code>.env</code> file for the <code>packages/api</code> or <code>packages/cli</code> directories.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws">AWS<a href="#aws" class="hash-link" aria-label="Direct link to AWS" title="Direct link to AWS">​</a></h3><p>To specify accounts for AWS, you can provide a list of account IDs to query using the <code>AWS_ACCOUNTS</code> variable.</p><p>Example:</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AWS_ACCOUNT=[&quot;account-1&quot;, &quot;account-2&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud">Google Cloud<a href="#google-cloud" class="hash-link" aria-label="Direct link to Google Cloud" title="Direct link to Google Cloud">​</a></h3><p>To specify accounts for Google Cloud, you can provide a list of project ids to query using the GCP_PROJECTS variable. Please keep in mind that the project id must be the unique ID generated for the project, and is not always the same as the project name.</p><p>Example:</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GCP_PROJECTS=[&quot;project-1&quot;, &quot;project-2&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure">Azure<a href="#azure" class="hash-link" aria-label="Direct link to Azure" title="Direct link to Azure">​</a></h3><p>To specify subscriptions for Azure, you can provide a list of subscription IDs to query using the <code>AZURE_SUBSCRIPTIONS</code> variable.</p><p>Example:</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AZURE_SUBSCRIPTIONS=[&quot;subscription-1&quot;, &quot;subscription-2&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/data-persistence-and-caching"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Data Persistence and Caching</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tagging"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tagging</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#improving-query-performance-and-handling-large-data" class="table-of-contents__link toc-highlight">Improving Query Performance and Handling Large Data</a></li><li><a href="#considerations-for-large-requests" class="table-of-contents__link toc-highlight">Considerations for Large Requests</a></li><li><a href="#date-range-considerations" class="table-of-contents__link toc-highlight">Date Range Considerations</a><ul><li><a href="#date-range-via-the-client" class="table-of-contents__link toc-highlight">Date Range via the Client</a></li><li><a href="#group-by-timestamp-in-queries" class="table-of-contents__link toc-highlight">Group By Timestamp in Queries</a></li></ul></li><li><a href="#azure-performance-considerations" class="table-of-contents__link toc-highlight">Azure Performance Considerations</a><ul><li><a href="#rate-limit-and-retry-logic" class="table-of-contents__link toc-highlight">Rate Limit and Retry Logic</a></li><li><a href="#configuration-options" class="table-of-contents__link toc-highlight">Configuration Options</a></li></ul></li><li><a href="#specifying-accounts" class="table-of-contents__link toc-highlight">Specifying Accounts</a><ul><li><a href="#aws" class="table-of-contents__link toc-highlight">AWS</a></li><li><a href="#google-cloud" class="table-of-contents__link toc-highlight">Google Cloud</a></li><li><a href="#azure" class="table-of-contents__link toc-highlight">Azure</a></li></ul></li></ul></div></div></div></div></main></div></div><div><div class="footerLicenseContainer_aMKa"><a class="footerLicenseLink_V4Yd signature_Phj5" target="_blank" href="https://www.thoughtworks.com">Made for the 🌎 by Thoughtworks</a><p>Cloud Carbon Footprint is an open-source project, sponsored by Thoughtworks Inc. under the <a class="footerLicenseLink_V4Yd undefined" target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a></p><p><a class="footerLicenseLink_V4Yd undefined" target="_blank" href="https://www.thoughtworks.com/privacy-policy">PRIVACY POLICY</a></p></div></div></div>
<script src="/assets/js/runtime~main.cb91f6b3.js"></script>
<script src="/assets/js/main.8fe9b0da.js"></script>
</body>
</html>